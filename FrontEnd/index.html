<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Title</title>
    <style>
      * {
        padding: 0;
        margin: 0;
      }
      
      body {
        background: #2d2d2d;
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        align-items: center;
        color: #ffffff;
      }

      canvas {
        margin: 0 auto;
      }
    </style>
    <script charset="utf-8" src="assets/js/pixi.min.js"></script>
    <script charset="utf-8" src="assets/js/viewport.js"></script>
  </head>
  <body>
    Testing Pixi with Viewport plugin<br />
    scroll to zoom | drag
    <script type="text/javascript">
      let type = "WebGL"
      if(!PIXI.utils.isWebGLSupported()){
        type = "canvas"
      }

      PIXI.utils.sayHello(type)

      let app = new PIXI.Application({
        width: 500, height: 500, backgroundColor: 0x000000,
        resolution: window.devicePixelRatio || 1,
      });
      // let app = new PIXI.Application();
      document.body.appendChild(app.view);
      let viewport = new Viewport.Viewport({
        screenWidth: window.innerWidth,
        screenHeight: window.innerHeight,
        worldWidth: 1000,
        worldHeight: 1000,
        interaction: app.renderer.plugins.interaction
      });
      app.stage.addChild(viewport);
      viewport
        .drag()
        .pinch()
        .wheel()
        .decelerate();

      // This is a dummy data set
      let frame = [
        {
          "playerid": 0,
          "color": "0xff0000",
          "coords": [
            {"x": 0, "y": 1},
            {"x": 20, "y": 50},
            {"x": 50, "y": 20}
          ]
        },
        {
          "playerid": 1,
          "color": "0x00ff00",
          "coords": [
            {"x": 50, "y": 0},
            {"x": 0, "y": 50},
            {"x": 20, "y": 20}
          ]
        },
        {
          "playerid": 2,
          "color": "0x0000ff",
          "coords": [
            {"x": -20, "y": 0},
            {"x": 0, "y": -50},
            {"x": 20, "y": -20}
          ]
        }
      ];

      frame.forEach(function(player) {
        console.log(player.coords)
        drawCells(player.coords, player.color);
      });

      function drawCells(coords, color) {
        coords.forEach(function(coord) {
          drawCell(coord, color);
        })
      }

      function drawCell(coord, color) {
        const sprite = viewport.addChild(new PIXI.Sprite(PIXI.Texture.WHITE))
        sprite.tint = color
        sprite.width = sprite.height = 10
        sprite.position.set(coord.x * 10, coord.y * 10)
      }
    </script>
  </body>
</html>
